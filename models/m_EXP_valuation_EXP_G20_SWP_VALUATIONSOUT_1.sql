{{ config( materialized='incremental', alias='EXP_G20_SWP_VALUATIONSOUT_1', schema='FIVETRAN_DB', pre_hook ="", post_hook ="", incremental_strategy='append' ) }} With SQ_EXP_G20_SWP_VALUATIONSOUT_301Out as ( Select SESSION_ID, USER_ID, DEVICE, START_TIME, END_TIME, SUCCESS, IP_ADDRESS from {{ source('sn_test_20', 'EXP_G20_SWP_VALUATIONSOUT_301') }} ), EXP_G20_SWP_VALUATIONSOUT_1_S10Out as ( Select SESSION_ID_o, SESSION_ID, USER_ID_o, USER_ID, DEVICE_o, DEVICE, START_TIME, END_TIME, SUCCESS, IP_ADDRESS from {{ source('sn_test_20', 'EXP_G20_SWP_VALUATIONSOUT_1') }} ), EXPTRANS1Out as ( Select SESSION_ID as SESSION_ID, LOWER ( 'SESSION_ID_o' ) as SESSION_ID_o, USER_ID as USER_ID, LENGTH ( 'USER_ID_o' ) as USER_ID_o, DEVICE as DEVICE, UPPER ( 'DEVICE_o' ) as DEVICE_o From SQ_EXP_G20_SWP_VALUATIONSOUT_301Out as SQ_EXP_G20_SWP_VALUATIONSOUT_301Out), LKPTRANS1Out as ( Select EXPTRANS1Out.SESSION_ID_o as SESSION_ID_o, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.SESSION_ID as SESSION_ID, EXPTRANS1Out.USER_ID_o as USER_ID_o, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.USER_ID as USER_ID, EXPTRANS1Out.DEVICE_o as DEVICE_o, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.DEVICE as DEVICE, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.START_TIME as START_TIME, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.END_TIME as END_TIME, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.SUCCESS as SUCCESS, EXP_G20_SWP_VALUATIONSOUT_1_S10Out.IP_ADDRESS as IP_ADDRESS FROM EXPTRANS1Out as EXPTRANS1Out LEFT JOIN EXP_G20_SWP_VALUATIONSOUT_1_S10Out as EXP_G20_SWP_VALUATIONSOUT_1_S10Out ON EXPTRANS1Out.SESSION_ID_o = EXP_G20_SWP_VALUATIONSOUT_1_S10Out.SESSION_ID And EXPTRANS1Out.USER_ID_o = EXP_G20_SWP_VALUATIONSOUT_1_S10Out.USER_ID And EXPTRANS1Out.DEVICE_o = EXP_G20_SWP_VALUATIONSOUT_1_S10Out.DEVICE ), DSR_EXP_G20_SWP_VALUATIONSOUT_1Out as ( Select LKPTRANS1Out.SESSION_ID_o as SESSION_ID, LKPTRANS1Out.USER_ID_o as USER_ID, LKPTRANS1Out.DEVICE_o as DEVICE, LKPTRANS1Out.START_TIME as START_TIME, LKPTRANS1Out.END_TIME as END_TIME, LKPTRANS1Out.SUCCESS as SUCCESS, LKPTRANS1Out.IP_ADDRESS as IP_ADDRESS From LKPTRANS1Out as LKPTRANS1Out) Select DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.IP_ADDRESS as IP_ADDRESS, DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.END_TIME as END_TIME, DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.START_TIME as START_TIME, DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.SUCCESS as SUCCESS, DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.SESSION_ID_o as SESSION_ID, DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.USER_ID_o as USER_ID, DSR_EXP_G20_SWP_VALUATIONSOUT_1Out.DEVICE_o as DEVICE From DSR_EXP_G20_SWP_VALUATIONSOUT_1Out as DSR_EXP_G20_SWP_VALUATIONSOUT_1Out;
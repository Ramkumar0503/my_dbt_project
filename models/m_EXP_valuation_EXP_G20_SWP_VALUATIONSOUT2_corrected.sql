{{ config( materialized='incremental', alias='EXP_G20_SWP_VALUATIONSOUT', schema='FIVETRAN_DBschema=', pre_hook ="", post_hook ="", incremental_strategy='append' ) }} With EXP_G20_SWP_VALUATIONSOUTOut as ( Select _FIVETRAN_ID_i, _FIVETRAN_ID, VALUATION_METHOD_i, VALUATION_METHOD, VALUATION_TIMESTAMP_i, VALUATION_TIMESTAMP, PARTY_CODE_DISPLAY_i, PARTY_CODE_DISPLAY, _FIVETRAN_DELETED_i, _FIVETRAN_DELETED, ACTION_TYPE, ACTION_TYPE_i, O_UPI, O_UPI_i, NPV, CURRENCY_CODE, PARTY_CODE_PREFIX_ALT_DISPLAY, UTI, PROPRIETARY_UTI_INDICATOR, O_LEGAL_ENTITY_IDENTIFIER, _FIVETRAN_SYNCED from {{ source('sn_sn_c09', 'EXP_G20_SWP_VALUATIONSOUT') }} ), SQ_EXP_G20_SWP_VALUATIONSOUTOut as ( Select _FIVETRAN_ID, VALUATION_METHOD, VALUATION_TIMESTAMP, PARTY_CODE_DISPLAY, _FIVETRAN_DELETED, ACTION_TYPE, O_UPI, NPV, CURRENCY_CODE, PARTY_CODE_PREFIX_ALT_DISPLAY, UTI, PROPRIETARY_UTI_INDICATOR, O_LEGAL_ENTITY_IDENTIFIER, _FIVETRAN_SYNCED from {{ source('sn_sn_c09', 'EXP_G20_SWP_VALUATIONSOUT') }} ), EXPTRANSOut as ( Select _FIVETRAN_ID as _FIVETRAN_ID, LOWER ( _FIVETRAN_ID ) as _FIVETRAN_ID_o, VALUATION_METHOD as VALUATION_METHOD, UPPER ( 'VALUATION_METHOD_o' ) as VALUATION_METHOD_o, VALUATION_TIMESTAMP as VALUATION_TIMESTAMP, PARTY_CODE_DISPLAY as PARTY_CODE_DISPLAY, LENGTH ( 'PARTY_CODE_DISPLAY_o' ) as PARTY_CODE_DISPLAY_o From SQ_EXP_G20_SWP_VALUATIONSOUTOut as SQ_EXP_G20_SWP_VALUATIONSOUTOut), DSR_FILTRANSOut as ( Select EXPTRANSOut1._FIVETRAN_ID_o as _FIVETRAN_ID, EXPTRANSOut1.PARTY_CODE_DISPLAY_o as PARTY_CODE_DISPLAY_o, EXPTRANSOut1.VALUATION_TIMESTAMP as VALUATION_TIMESTAMP, EXPTRANSOut1.VALUATION_METHOD as VALUATION_METHOD From EXPTRANSOut as EXPTRANSOut), FILTRANSOut as ( Select VALUATION_TIMESTAMP as VALUATION_TIMESTAMP, _FIVETRAN_ID_o as _FIVETRAN_ID, VALUATION_METHOD as VALUATION_METHOD From DSR_FILTRANSOut as DSR_FILTRANSOut Where dsCheckIsNotNull(_FIVETRAN_ID)), LKPTRANSOut as ( Select EXP_G20_SWP_VALUATIONSOUTOut._FIVETRAN_ID as _FIVETRAN_ID, EXP_G20_SWP_VALUATIONSOUTOut.VALUATION_METHOD as VALUATION_METHOD, EXP_G20_SWP_VALUATIONSOUTOut.VALUATION_TIMESTAMP as VALUATION_TIMESTAMP, EXP_G20_SWP_VALUATIONSOUTOut.PARTY_CODE_DISPLAY as PARTY_CODE_DISPLAY, EXP_G20_SWP_VALUATIONSOUTOut._FIVETRAN_DELETED as _FIVETRAN_DELETED, EXP_G20_SWP_VALUATIONSOUTOut.ACTION_TYPE as ACTION_TYPE, EXP_G20_SWP_VALUATIONSOUTOut.O_UPI as O_UPI, EXP_G20_SWP_VALUATIONSOUTOut.NPV as NPV, EXP_G20_SWP_VALUATIONSOUTOut.CURRENCY_CODE as CURRENCY_CODE, EXP_G20_SWP_VALUATIONSOUTOut.PARTY_CODE_PREFIX_ALT_DISPLAY as PARTY_CODE_PREFIX_ALT_DISPLAY, EXP_G20_SWP_VALUATIONSOUTOut.UTI as UTI, EXP_G20_SWP_VALUATIONSOUTOut.PROPRIETARY_UTI_INDICATOR as PROPRIETARY_UTI_INDICATOR, EXP_G20_SWP_VALUATIONSOUTOut.O_LEGAL_ENTITY_IDENTIFIER as O_LEGAL_ENTITY_IDENTIFIER, EXP_G20_SWP_VALUATIONSOUTOut._FIVETRAN_SYNCED as _FIVETRAN_SYNCED FROM EXP_G20_SWP_VALUATIONSOUTOut as EXP_G20_SWP_VALUATIONSOUTOut LEFT JOIN EXP_G20_SWP_VALUATIONSOUTOut as EXP_G20_SWP_VALUATIONSOUTOut ON EXP_G20_SWP_VALUATIONSOUTOut._FIVETRAN_ID_o = EXP_G20_SWP_VALUATIONSOUTOut._FIVETRAN_ID And EXP_G20_SWP_VALUATIONSOUTOut.VALUATION_METHOD = EXP_G20_SWP_VALUATIONSOUTOut.VALUATION_METHOD And EXP_G20_SWP_VALUATIONSOUTOut.VALUATION_TIMESTAMP = EXP_G20_SWP_VALUATIONSOUTOut.VALUATION_TIMESTAMP And EXP_G20_SWP_VALUATIONSOUTOut.PARTY_CODE_DISPLAY_i = EXP_G20_SWP_VALUATIONSOUTOut.PARTY_CODE_DISPLAY And EXP_G20_SWP_VALUATIONSOUTOut.ACTION_TYPE_i = EXP_G20_SWP_VALUATIONSOUTOut.ACTION_TYPE ) Select _FIVETRAN_ID as _FIVETRAN_ID, VALUATION_METHOD as VALUATION_METHOD, VALUATION_TIMESTAMP as VALUATION_TIMESTAMP, null as PARTY_CODE_DISPLAY, null as _FIVETRAN_DELETED, null as ACTION_TYPE, null as O_UPI, null as NPV, null as CURRENCY_CODE, null as PARTY_CODE_PREFIX_ALT_DISPLAY, null as UTI, null as PROPRIETARY_UTI_INDICATOR, null as O_LEGAL_ENTITY_IDENTIFIER, null as _FIVETRAN_SYNCED From LKPTRANSOut as LKPTRANSOut;